% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prepare.R
\name{step_trim_outliers}
\alias{step_trim_outliers}
\title{Step: trim or winsorize outliers}
\usage{
step_trim_outliers(
  var,
  method = c("iqr", "mad", "sd"),
  k = 3,
  action = c("remove", "winsorize")
)
}
\arguments{
\item{var}{A tidy‑eval column identifying the \strong{numeric} variable to trim.}

\item{method}{Outlier rule; one of \code{"iqr"}, \code{"mad"}, or \code{"sd"}.}

\item{k}{Multiplier for the chosen scale (IQR, MAD, or SD); defaults to \code{3}.
For IQR, fences are \code{Q1 - k*IQR} and \code{Q3 + k*IQR}; for MAD, \verb{median ± k*MAD};
for SD, \verb{mean ± k*SD}.}

\item{action}{One of \code{"remove"} or \code{"winsorize"}.}
}
\value{
A function suitable for use inside \code{\link[=prepare]{prepare()}}'s \code{steps} list.
}
\description{
Create a preparation step that flags outliers using common rules and
either removes them or winsorizes them to the nearest fence. Available
methods are the interquartile range (IQR), median absolute deviation (MAD),
and standard deviation (SD). Defaults follow the guidance in the
\href{https://r4np.com/09_sources_of_bias.html#sec-dealing-with-outliers}{\emph{r4np} book}.
}
\details{
This is a \emph{step constructor}: it returns a function with signature
\verb{function(df, spec)} that:
\itemize{
\item Validates the target variable,
\item Computes method-specific fences,
\item Applies the chosen action,
\item Returns \code{list(df = updated_df, log = one_row_tibble)} where the log
contains \code{step}, \code{var}, \code{method}, \code{k}, \code{action}, \code{n_before}, \code{n_after},
and \code{n_changed}.
}
}
\examples{
# Winsorize extreme values of `mpg` to IQR fences
step <- step_trim_outliers(mpg, method = "iqr", k = 3, action = "winsorize")
res <- step(df = mtcars, spec = comp_spec(mtcars))
res$log

# Use as part of a preparation pipeline
spec <- comp_spec(mtcars)
spec <- prepare(spec, steps = list(step_trim_outliers(mpg, method = "sd", action = "remove")))
spec$prep_log
}
